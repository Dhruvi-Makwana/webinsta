{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

    <link rel="stylesheet" href="{% static 'css/base.css' %}"  type="text/css">
    <script src="{% static 'js/base.js' %}"></script>
    <title>Instagram </title>
</head>
<body>


    <div class="container-fluid">

        <div class="mt-3 row header_position">
            <div class="col-2 ms-3">
                <img src="{% static 'images/logo2.png' %}" height="50px" width="50px">
            </div>
                
            <div class="col">
                <a type="button" href="#" class="float-end btn border text-black">Logout</a>
            </div>
        </div>

        <!--
            post card stating from here....
        -->
        <div class="mt-3">
            <div class="card center_div">

                <!--
                    card-header to show insta username
                -->
                <div class="card-header">
                    <div class="row">
                        <div class="col-1">
                            <img src="{% static 'images/logo2.png' %}" height="20px" width="20px">
                        </div>
                        <div class="col-11 font_class"><span>abc_@45</span></div>
                    </div>
                </div>

                <!--
                    card-body which cpontain post image
                -->
                <div class="card-body mb-3 mt-3">
                    <div class="post_img_center">
                        <img src="{% static 'images/nature.jpeg'%} " height="200px" width="250px">
                    </div>
                </div>
                <!--
                    post footer to which contain comment and caption
                -->
                <div class="card-footer">
                    <div class="row">
                        <div class="col-1  mt-1">
                            <img src="{% static 'images/heart.svg' %}" height="20px" width="20px">
                        </div>
                        <!--
                            2nd column for comment on comment button click collaps work
                        -->
                        <div class="col-11">
                            <a type="button" class="btn btn-light font_class" data-bs-toggle="collapse" data-bs-target="#comment-toggle">Comment</a>
                            <div id="comment-toggle" class="collapse">
                                <!--
                                    to submit a comment form starting from here
                                -->
                               <form>
                                <div class="mb-3 mt-3">
                                    <input type="text" class="form-control" id="title" placeholder="Add Comment" name="pswd">
                                </div>
                                <a type="button" class="btn btn-primary">Add Comment</a>
                               </form>
                            </div>
                        </div>
                        <!--
                            to see caption of the post
                        -->
                        <div class="ms-4 mt-2">
                            <h7 class="font_class fw-bold fst-italic">Userid</h7>
                            <h6 class="font_class pe-3">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Doloribus sed iure sequi vitae fuga perferendis quisquam, doloremque totam quod aspernatur.</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>



<!--
    Create post modal
-->




<div class="modal fade" id="postmodal" tabindex="-1" data-bs-backdrop="true" data-bs-keyboard="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
            <h2 class="font_class">Post</h2>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
            <!--
                to save a post with image and data form starting here..
            -->
                <form method="post" enctype="multipart/form-data" id="post_form">
                    {% csrf_token %}
                    <div>
                        <center><img src="{% static 'images/nature.jpeg' %}" alt="Cinque Terre" height="200px" width="300px" id="post_target"></center>
                    </div>
                    <div class="mb-3">
                        <label for="post_img" class="mt-2" style="margin-left: 190px;"><span class="btn">Add Post</span></label>
                        <input type="file" id="post_img" name="images" accept="image/*" style="display:none">
                    </div>

                    <div class="mb-3">
                       <input type="text" width="20px" name="content" class="form-control" id="title" placeholder="Enter description"></textarea>
                    </div>
               



        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <input type="submit" class="btn btn-primary" value="submit">
        </div>
         </form>
      </div>
    </div>
</div>




  <!--
    Edit profile modal
-->


<div class="modal fade" id="edit_profile_modal" tabindex="-1" data-bs-backdrop="true" data-bs-keyboard="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
            <h2 class="font_class text-center">Edit your profile here...</h2>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <!--
                update profile form
            -->
                <form  method="patch" enctype="multipart/form-data" id="edit_profile_form">
                    {% csrf_token %}
                    <div>
                        <center><img src="{% static 'images/nature.jpeg' %} " alt="Cinque Terre" height="150px" width="150px" id="target"></center>
                    </div>
                    <div class="mb-3">
                        <label for="img" class="mt-2" style="margin-left: 170px;"><span class="btn">Edit Profile</span></label>
                        <input type="file" id="img" name="profile" accept="image/*" style="display:none">
                    </div>
                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" id="" name="first_name" placeholder="Edit Fisrt Name">
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" id="" name="last_name" placeholder="edit Last Name">
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" name="username" id="" placeholder="Edit Username" >
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" name="password" id="" placeholder="Reset password" >
                    </div>



        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <input type="submit" class="btn btn-primary" value="submit">
        </div>
    </form>
    </div>
</div>
</div>




<!--
    Footer
-->

        <div class="footer">
            <div class="row">
                <div class="col-1"></div>
                    <div class="col-10 d-flex justify-content-center">
                        <!--
                            main news feed pahe
                        -->
                        <a href="#" class="font_class pe-4"><span><img src="{% static 'images/house-door-fill.svg'%}" height="30px" width="30px" class="rounded-4 m-2"></span><span class="vertical_align">News Feed</span></a>
                        <!--
                            add post buttoon
                        -->
                        <a href="#" class="font_class pe-4" id="post_modal_btnid" data-bs-toggle="modal"><span><img src="{% static 'images/plus-square-fill.svg' %} " height="30px" width="30px" class="rounded-4 m-2"></span><span class="vertical_align">What's in your Mind</span></a>
                        <!--
                            edit profile button
                        -->
                        <a href="#" class="font_class" id="editprofile_modal_btnid" data-bs-toggle="modal"><span><img src="{% static 'images/person-circle (1).svg' %}" height="30px" width="30px" class="rounded-4 m-2"></span><span class="vertical_align">Profile</span></a>
                    </div>
                <div class="col-1"></div>
            </div>
        </div>
    </div>
</body>







<script>
    //post modal js
let myModal = new bootstrap.Modal(document.getElementById('postmodal'))

document.getElementById('post_modal_btnid').addEventListener('click', function() {
  myModal.show()    
})


// Edit Profile modals js
let editprofilemodal = new bootstrap.Modal(document.getElementById('edit_profile_modal'))

document.getElementById('editprofile_modal_btnid').addEventListener('click', function() {
    editprofilemodal.show()
})



//set user profile image
function showImage(img,target) {
  var fr=new FileReader();
  // when image is loaded, set the src of the image where you want to display it
  fr.onload = function(e) { target.src = this.result; };
  img.addEventListener("change",function() {
    // fill fr with image data
    fr.readAsDataURL(img.files[0]);
  });
}

var src = document.getElementById("img");
var target = document.getElementById("target");
showImage(src,target);




//post image set preview
function showImage(post_img,post_target) {
  var fr=new FileReader();
  // when image is loaded, set the src of the image where you want to display it
  fr.onload = function(e) { post_target.src = this.result; };
  post_img.addEventListener("change",function() {
    // fill fr with image data
    fr.readAsDataURL(post_img.files[0]);
  });
}

var post_src = document.getElementById("post_img");
var target_post = document.getElementById("post_target");
showImage(post_src,target_post);


// add post

$(document).on("submit", "#post_form", function (event) {
    event.preventDefault();
    event.stopImmediatePropagation();
    var formData = new FormData(this);

    $.ajax({
        method: 'POST',
        headers: {'X-CSRFToken': '{{ csrf_token }}'},
        url: "/homepage/",
        data: formData,
        contentType: false,
        success: function (data){
            if(data){
               alert("post created.")
                }  
        },
        error: function() {
            alert('enter a valid data')
        }, 
        cache: false,
        contentType: false,
        processData: false
    });
    return false;
})



// edit profile AJAX
$(document).on("submit", "#edit_profile_form", function (event) {
    event.preventDefault();
    event.stopImmediatePropagation();
    var formData = new FormData(this);
    $.ajax({
        method: 'PATCH',
        headers: {'X-CSRFToken': '{{ csrf_token }}'},
        url: "/homepage/",
        data: formData,
        contentType: false,
        success: function (data){
            if(data){
               alert("edit user.")
                }  
        },
        error: function() {
            alert('enter a valid data')
        }, 
        cache: false,
        contentType: false,
        processData: false
    });
    return false;
})
</script>
</html>